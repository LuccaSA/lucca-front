@use '@lucca-front/scss/src/commons/utils/a11y';

@mixin component($atRoot: 'without: rule') {
    position: relative;
    display: table;
    width: 100%;
    padding: 0 var(--spacings-XS) var(--spacings-XS);
    border-collapse: separate;
    border-spacing: 0 var(--components-indexTable-row-spacing);
    border-radius: var(--components-indexTable-border-radius);
    background-color: var(--components-indexTable-background-color);
    color: var(--palettes-neutral-800);

    @at-root ($atRoot) {
        .indexTable-head {
            display: table-header-group;
            vertical-align: bottom;
        }

        .indexTable-body {
            display: table-row-group;
        }

        //There might be more than one footer
        .indexTable-foot {
            display: table-row-group;
            &:is(tfoot) {
                display: table-footer-group;
            }
        }

        .indexTable-head-row,
        .indexTable-body-row,
        .indexTable-foot-row {
            display: table-row;
        }

        .indexTable-body-row {
            cursor: pointer;
            border-radius: var(--commons-borderRadius-L);

            &:is(:focus-within, :hover) {
                --components-indexTable-cell-shadow: var(--commons-boxShadow-L);
            }

            &:focus-within {
                @include a11y.focusVisible();
            }

            &:hover {
                --components-indexTable-cell-inset-x: var(--components-indexTable-hover-offset-x);
                --components-indexTable-cell-inset-y: var(--components-indexTable-hover-offset-y);
            }
        }

        .indexTable-head-row-transparentCell,
        .indexTable-body-row-transparentCell,
        .indexTable-head-row-cell,
        .indexTable-body-row-cell,
        .indexTable-foot-row-cell {
            display: table-cell;
            vertical-align: middle;
            text-align: left;
        }

        .indexTable-head-row-cell {
            padding: var(--spacings-XS) var(--components-indexTable-padding);
            color: var(--palettes-neutral-600);
            font-weight: 400;
        }

        .indexTable-body-row-cell {
            position: relative;
            z-index: 1;
            padding: var(--components-indexTable-padding);
            border-radius: var(--components-table-cardList-cell-border-radius);

            // apparence of the first cell with a card apparence.
            // we do this because there migh be one or two cells before without background and containing a checkbox
            --components-indexTable-shadow-mask: 0 0 0 0;
            --components-indexTable-cell-border-radius: var(--commons-borderRadius-L) 0 0 var(--commons-borderRadius-L);
            --components-indexTable-cell-inset-x-left: var(--components-indexTable-cell-inset-x);

            // apparence of the nexts cells
            ~ .indexTable-body-row-cell {
                --components-indexTable-shadow-mask: var(--components-indexTable-shadow-mask-default);
                --components-indexTable-cell-border-radius: 0;
                --components-indexTable-cell-inset-x-left: 0;
            }

            // apparence of the last cell with a card apparence
            &:last-child {
                --components-indexTable-cell-border-radius: 0 var(--commons-borderRadius-L)
                    var(--commons-borderRadius-L) 0;
                --components-indexTable-cell-inset-x-right: var(--components-indexTable-cell-inset-x);
            }

            &::before,
            &::after {
                transition-property: inset, box-shadow, background-color;
                transition-duration: var(--commons-animations-durations-standard);
            }

            // the card apparence is put on a ::before pseudo element
            &::before {
                content: '';
                position: absolute;
                inset: var(--components-indexTable-cell-inset-y, 0) var(--components-indexTable-cell-inset-x-right, 0)
                    var(--components-indexTable-cell-inset-y, 0) var(--components-indexTable-cell-inset-x-left, 0);
                z-index: -1;
                border-radius: var(--components-indexTable-cell-border-radius, 0);
                background-color: var(--components-indexTable-cell-background-color, var(--colors-white-color));
                // shadow-mask : since the card apparence is put on every cell (du to a Safari bug), we need to hide the left part of the box shadow for everycell exept the first one.
                // We do this with a rectangular white box-shadow above it.
                box-shadow: var(--components-indexTable-shadow-mask),
                    var(--components-indexTable-cell-shadow, var(--commons-boxShadow-S));
            }
        }

        .indexTable-body-row-cell-action {
            @include a11y.mask;
        }

        .indexTable-body-row-cellTitle {
            display: flex;
            align-items: center;
            gap: var(--spacings-XXS);
        }

        .indexTable-body-row-cellTitle-button .lucca-icon {
            transition: transform var(--commons-animations-durations-fast) ease;
        }

        .indexTable-foot-row-cell {
            padding: var(--spacings-XS) var(--components-indexTable-padding);
            text-align: right;
        }
    }
}
