@use '@lucca-front/scss/src/commons/utils/a11y';

@mixin component($atRoot: 'without: rule') {
  //display: flex;
  //justify-content: center;

	@at-root ($atRoot) {
    .timePicker-fieldset {
    	display: inline-flex;
    	align-items: center;
    	gap: var(--pr-t-spacings-50);
    	padding: var(--pr-t-spacings-50) var(--pr-t-spacings-100);
    	background-color: var(--colors-white-color);
    	border-radius: var(--commons-borderRadius-M);
    	border: 0;
    	box-shadow: var(--components-timepicker-border);
    	font-size: var(--components-timepicker-fontSize);
    	line-height: var(--components-timepicker-lineHeight);
    	z-index: 1;
    	margin: 0;
    	cursor: text;

    	&:hover {
    		--components-timepicker-border: 0 0 0 1px var(--palettes-400, var(--palettes-grey-400));
    	}

    	&:focus-within,
    	&:focus-visible {
    		@include a11y.focusVisible($offset: 3px);
    	}
    }

    .timePicker-fieldset-suffix {
    	display: flex;
    	justify-content: center;
    	pointer-events: none;
    }

    .timePicker-fieldset-group {
    	position: relative;
    	display: inline-block;
    }

    .timePicker-fieldset-group-textfield {
    	display: block;
    	outline: none;
    }

    input.timePicker-fieldset-group-textfield-input {
      opacity: 0;
    }

    .timePicker-fieldset-group-textfield-input {
    	display: flex;
    	align-items: center;
    	justify-content: center;
    	border-radius: var(--commons-borderRadius-M);
    	border: 0;
    	text-align: center;
    	height: var(--components-timepicker-input-height);
    	width: var(--components-timepicker-input-width);

    	&.mod-L {
    		width: 1.8rem;
    	}

    	&.mod-XL {
    		width: 2.5rem;
    	}

    	&[type='number'] {
    		/* stylelint-disable-next-line property-no-vendor-prefix */
    		-moz-appearance: textfield;

    		/* stylelint-disable-next-line rule-empty-line-before */
    		&::-webkit-outer-spin-button,
    		&::-webkit-inner-spin-button {
    			/* stylelint-disable-next-line property-no-vendor-prefix */
    			-webkit-appearance: none;
    			margin: 0;
    		}
    	}

      &:focus-visible + .timePicker-fieldset-group-textfield-display {
      	background-color: var(--palettes-primary-100);
      }
    }

    .timePicker-fieldset-group-textfield-display {
    	position: absolute;
    	top: 50%;
    	left: 50%;
    	transform: translate(-50%, -50%);
    	pointer-events: none;
    	padding: 0.15rem;

    	color: var(--palettes-grey-800);
    }

    .timePicker-fieldset-group-button {
    	position: absolute;
    	bottom: calc(100% + 0.5rem);
    	left: 0;
    	right: 0;
    	width: 100%;
    	border: 0;
    	padding: 0;
    	height: 1rem;
    	background-color: transparent;
    	cursor: pointer;

    	// style actionIcon
    	display: inline-flex;
    	justify-content: center;
    	align-items: center;
    	border-radius: var(--commons-borderRadius-M);

    	&:not([disabled], .is-disabled, [readonly], .is-readonly) {
    		&:hover {
    			cursor: pointer;
    			background-color: var(--palettes-grey-50);
    			color: var(--palettes-grey-800);
    		}

    		&:focus-visible {
    			background-color: var(--palettes-grey-100);
    			color: var(--palettes-grey-800);
    			outline: none;
    		}
    	}

    	&:is(.is-disabled, .disabled, [disabled]) {
    		color: var(--palettes-grey-500);
    		cursor: default;
    	}

    	.lucca-icon {
    		font-size: 1rem;
    	}

    	+ .timePicker-fieldset-group-button {
    		top: calc(100% + 0.5rem);
    		bottom: auto;
    	}
    }

    .timePicker-skeletonOverlay {
    	inset: 0.75rem;
    	position: absolute;
    	border-radius: 0.8rem;
    	animation-name: aniUISkeleton;
    	animation-duration: 1s;
    	animation-timing-function: linear;
    	animation-iteration-count: infinite;
    	background: linear-gradient(90deg, var(--palettes-grey-100), var(--palettes-grey-50), var(--palettes-grey-100));
    	background-size: 150%;
    }
	}


  // TODO : Voir pourquoi Laurent avait supprimé ca dans la PR #2710.
  // Le design du picker jour était cassé.

  // &:not(.is-readonly) {
  //   &.mod-duration {
  //     .timePicker-fieldset {
  //       display: grid;
  //       grid-template-columns: 1fr max-content;
  //       width: 4rem;
  //       justify-content: center;
  //       align-items: center;
  //       gap: 0;
  //     }
  //
  //     .timePicker-fieldset-group {
  //       grid-column: 1/3;
  //       grid-row: 1;
  //     }
  //
  //     .timePicker-fieldset-suffix {
  //       grid-column: 2/3;
  //       grid-row: 1;
  //       padding-right: var(--spacings-XXS);
  //     }
  //
  //     .timePicker-fieldset-group-textfield-input {
  //       width: 2.5rem;
  //       margin-left: 0.25rem;
  //     }
  //   }
  // }

  // &:not(.is-button) {
  //   .timePicker-fieldset-group-textfield-input {
  //     &[type='number'] {
  //       &:hover,
  //       &:focus,
  //       &:focus-visible {
  //         background-color: var(--palettes-100, var(--palettes-primary-100));
  //         outline: none;
  //       }
  //     }
  //   }
  // }

  // &.is-button {
  //   .timePicker-fieldset {
  //     background-color: var(--colors-white-color);
  //     cursor: pointer;
  //   }
  // }

  // &.palette-error {
  //   .timePicker-fieldset {
  //     &:focus-within,
  //     &:focus-visible {
  //       @include a11y.focusVisible($color: var(--palettes-error-700));
  //     }
  //   }
  // }
  //
  // &:not(.palette-error) {
  //   &.is-readonly {
  //     .timePicker-fieldset {
  //       --components-timepicker-border: 0 0 0 1px var(--colors-white-color);
  //     }
  //   }
  // }
}
