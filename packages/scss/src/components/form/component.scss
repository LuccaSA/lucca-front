@use '@lucca-front/scss/src/commons/utils/form';
@use '@lucca-front/scss/src/components/formLabel/exports' as formLabel;
@use '@lucca-front/scss/src/components/inlineMessage/exports' as inlineMessage;
@use '@lucca-front/scss/src/components/textField/exports' as textField;

@mixin component($atRoot: 'without: rule') {
	padding: 0;
	border: 0;
	margin: 0 0 var(--components-form-group-margin-bottom);
	position: relative;

	@at-root ($atRoot) {
		.form-field {
			display: flex;
			flex-direction: column;
			gap: var(--spacings-XXS);

			&.is-invalid, &:has(.textField-input-value[aria-invalid="true"]) {
				.textField {
					@include textField.invalid;
				}

				.formLabel {
					@include formLabel.error;
				}

				.inlineMessage {
					@include inlineMessage.error;
				}
			}

			&.is-disabled, &:has(.textField-input-value[disabled]) {
				.textField {
					@include textField.disabled;
				}
			}

			&.mod-S {
				.formLabel {
					@include formLabel.S;
				}

				.textField {
					@include textField.S;
				}
			}

			&.mod-XS {
				.formLabel {
					@include formLabel.XS;
				}

				.inlineMessage {
					@include inlineMessage.S;
				}

				.textField {
					@include textField.XS;
				}
			}
		}

		// Legacy

		.form-group-label,
		.form-group-legend,
		.form-group-title {
			display: block;
			font-weight: 600;
			font-size: var(--components-form-label-font-size);
			margin: 0;
			padding: 0 0 var(--components-form-label-margin-bottom);
			width: 100%;
			text-align: left;
		}

		.form-group-legend,
		.form-group-title {
			font-size: var(--components-field-framed-title-font-size);
			line-height: var(--components-field-framed-title-line-height);
			padding-bottom: var(--spacings-XXS);
		}

		.form-actions {
			text-align: right;
		}

		.form {
			.textfield,
			.radiosfield,
			.checkboxesfield,
			.checkbox.mod-field {
				margin-bottom: var(--components-form-field-margin-bottom);
			}
		}

		.form-group-line {
			display: flex;
			flex-wrap: wrap;
			position: relative;
		}

		.form-group-line-col {
			flex-basis: 0;
			flex-grow: 1;
			display: flex;
			flex-direction: column;

			> * {
				flex-grow: 1;
			}
		}

		.form-group-label {
			&.is-required {
				&:not(:empty) {
					&::after {
						@include form.required;
					}
				}
			}
		}

		.radiosfield-label,
		.checkboxesfield-label,
		.textfield-label {
			&.is-required {
				&:not(:empty) {
					&::after {
						@include form.required;
					}
				}
			}
		}
	}
}
