<div class="lu-select-placeholder">{{placeholder}}</div>
<div class="lu-select-value">
	<div class="lu-select-display-wrapper">
		<ng-container #display></ng-container>
	</div>
</div>
<div class="lu-select-suffix">
	<lu-input-clearer></lu-input-clearer>
</div>

<ng-template luDisplayer [luDisplayerMultiple]="true" let-values>
	<span *ngIf="multiple && values?.length > 1; else: singleView"><span
			class="chip mod-unkillable">{{values.length}}</span> {{intl.establishments}}</span>
	<ng-template #singleView>{{(values[0] || values).name}}</ng-template>
</ng-template>

<lu-option-picker-advanced [option-comparer]="byId">
	<header class="lu-picker-header">
		<lu-establishment-searcher [filters]="filters" sort="legalunit.name,name"
			(isSearching)="onIsSearchingChanged($event)"></lu-establishment-searcher>
		<lu-option-select-all *ngIf="multiple" class="u-displayBlock u-marginSmaller"></lu-option-select-all>
	</header>

	<ng-template luForLegalUnits let-group>

		<ng-container *ngIf="!isSearching">
			<div class="optionGroupName" *ngIf="multiple; else singleViewGroup">
				<button class="button mod-link" [luLegalUnitSelector]="group.key">{{group.key.name}}</button>
			</div>
			<ng-template #singleViewGroup>
				<div class="optionGroupName">
					<h5>{{group.key.name }}</h5>
				</div>
			</ng-template>
		</ng-container>

		<lu-option *ngFor="let establishment of group.items; trackBy: trackById" [value]="establishment"
			class="establishmentOption">
			<ng-container *ngIf="isSearching; else emptySearch">
				<span class="u-displayBlock" [innerHtml]="establishmentDisplayer(establishment) | async"></span>
				<span class="u-displayBlock u-textLight u-textSmall">{{ group.key.name }}</span>
			</ng-container>
			<ng-template #emptySearch>
				<span [innerHtml]="establishmentDisplayer(establishment) | async"></span>
			</ng-template>
		</lu-option>
	</ng-template>
</lu-option-picker-advanced>