<div class="lu-select-placeholder">{{ placeholder }}</div>
<div class="lu-select-value">
	<div class="lu-select-display-wrapper">
		<ng-container #display />
	</div>
</div>
<div class="lu-select-suffix">
	<lu-clear />
</div>

<ng-template luDisplayer [luDisplayerMultiple]="true" let-values>
	@if (multiple && values?.length > 1) {
		<span
			><span class="numericBadge">{{ values.length }}</span> {{ intl.establishments }}</span
		>
	} @else {
		{{ (values[0] || values).name }}
	}
</ng-template>

<lu-option-picker-advanced [option-comparer]="byId">
	<header class="lu-picker-header">
		<lu-establishment-searcher
			[filters]="filters"
			[appInstanceId]="appInstanceId"
			[operations]="operations"
			[sort]="sort"
			(isSearching)="onIsSearchingChanged($event)"
		/>
		@if (multiple) {
			<lu-establishment-select-all
				class="pr-u-displayBlock"
				[class.pr-u-displayNone]="isSearching"
				[filters]="filters"
				[appInstanceId]="appInstanceId"
				[operations]="operations"
			/>
		}
	</header>

	<ng-template luForLegalUnits let-group>
		<div class="optionGroup">
			@if (groupByLu && !isSearching) {
				@if (multiple) {
					<button
						type="button"
						class="optionGroupName button mod-ghost mod-block"
						[luLegalUnitSelector]="group.key"
						[luLegalUnitSelectorFilters]="filters"
						[luLegalUnitSelectorAppInstanceId]="appInstanceId"
						[luLegalUnitSelectorOperations]="operations"
					>
						{{ group.key.name }}
					</button>
				} @else {
					<h5 class="optionGroupName mod-readonly pr-u-margin0">{{ group.key.name }}</h5>
				}
			}

			<div class="lu-picker-content-option">
				@for (establishment of group.items; track establishment.id) {
					<lu-option [value]="establishment" class="establishmentOption">
						@if (isSearching) {
							<span class="pr-u-displayBlock" translate="no">{{ establishment.name }}</span>
							@if (groupByLu) {
								<span class="pr-u-displayBlock pr-u-textLight pr-u-bodyS">{{ group.key.name }}</span>
							}
						} @else {
							<span translate="no">{{ establishment.name }}</span>
						}
					</lu-option>
				}
			</div>
		</div>
	</ng-template>
</lu-option-picker-advanced>
