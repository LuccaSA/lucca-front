<div class="textField">
	<div class="textField-input">
		<!-- TODO add mod clearable -->
		<input
			type="text"
			id="date"
			#date
			luInput
			class="textField-input-value"
			aria-labelledby="dateLabel"
			aria-describedby="dateMessage"
			[value]="displayValue()"
			(input)="userTextInput.set(date.value)"
			(blur)="onTouched?.()"
			aria-haspopup="true"
			role="combobox"
			(click)="popoverRef.openPopover(true, true)"
			(keyup.arrowDown)="popoverRef.opened() ? popoverRef.focusBackToContent($event) : popoverRef.openPopover(true)"
			(keyup.space)=" popoverRef.opened() ? popoverRef.focusBackToContent($event) : popoverRef.openPopover(true)"
			(keyup.escape)="popoverRef.close()"
			[disabled]="disabled"
			[attr.style]="clearable() ? 'padding-right: 4rem' : null"
		/>
		<div class="textField-input-affix">
			@if (clearable()) {
			<button class="clear u-pointerEventsAuto" type="button" (click)="clear()">
				<span class="u-mask">{{ intl.clear }}</span>
			</button>
			}
			<button
				[luPopover2]="calendar"
				[disabled]="disabled"
				[luPopoverNoCloseButton]="true"
				#popoverRef="luPopover2"
				[customPositions]="popoverPositions"
				tabindex="-1"
				type="button"
				class="button mod-onlyIcon mod-text textField-input-affix-toggle"
			>
				<lu-icon [icon]="'calendarDate'" [alt]="intl.pickDate"></lu-icon>
			</button>
		</div>
	</div>
</div>

<ng-template #calendar>
	<div class="calendarWrapper">
		<div class="calendarWrapper-navigation mod-prev">
			<button class="calendarWrapper-navigation-button button" type="button" (click)="prev()" #previousButtonRef>
				<span aria-hidden="true" class="lucca-icon icon-chevronLeft"></span><span class="u-mask">{{ intl.previous }}</span>
			</button>
		</div>
		<div class="calendarWrapper-navigation mod-next">
			<button class="calendarWrapper-navigation-button button" type="button" (click)="next()" #nextButtonRef>
				<span aria-hidden="true" class="lucca-icon icon-chevronRight"></span><span class="u-mask"> {{ intl.next }}</span>
			</button>
		</div>
		<div class="calendarWrapper-content" tabindex="-1">
			<lu-calendar2
				[enableOverflow]="enableOverflow()"
				[showOverflow]="showOverflow()"
				[hideToday]="hideToday()"
				[date]="currentDate()"
				(dateChange)="currentDateChangeFromCalendar($event)"
				[(tabbableDate)]="tabbableDate"
				[getCellInfo]="combinedGetCellInfo"
				[ranges]="ranges()"
				(dateClicked)="selectedDate.set($event);popoverRef.close()"
				(nextPage)="move(1)"
				(previousPage)="move(-1)"
				mode="month"
				[(displayMode)]="calendarMode"
			></lu-calendar2>
		</div>
	</div>
</ng-template>
