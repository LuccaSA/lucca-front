@if (employee$ | async; as employee) {
	<div class="userPopover pr-u-animatedFadeIn">
		<section class="userPopover-details">
			<div class="userPopover-details-avatar avatar">
				@switch (userPictureDisplay$ | async) {
					@case ("img") {
						<img
							class="avatar-picture"
							[src]="userPictureHref$ | async"
							[alt]="(userInitials$ | async)?.initials"
							(error)="pictureError()"
							translate="no"
						/>
					}
					@case ("initials") {
						@if (userInitials$ | async; as initials) {
							<div class="avatar-picture" style.background-color="hsl({{ initials.color }}, 60%, 60%)">
								<span class="avatar-picture-initials" translate="no">{{ initials.initials }}</span>
							</div>
						}
					}
				}
			</div>
			<div class="userPopover-details-info">
				<h1 class="userPopover-details-info-name pr-u-ellipsis">
					@if (!employee._links?.hrCard?.href) {
						<ng-container *ngTemplateOutlet="fullNameDisplay" />
					} @else {
						<a class="userPopover-details-info-name-linkOptional" [href]="employee._links?.hrCard?.href">
							<ng-container *ngTemplateOutlet="fullNameDisplay" />
						</a>
					}
				</h1>
				<ng-template #fullNameDisplay
					><span translate="no">{{ employee.firstName }} {{ employee.lastName }}</span></ng-template
				>
				@if (employee.jobTitle) {
					<p class="userPopover-details-info-detail pr-u-ellipsis">{{ employee.jobTitle }}</p>
				}
				@if (employee.userDepartment?.name) {
					<p class="userPopover-details-info-detail pr-u-ellipsis">{{ employee.userDepartment?.name }}</p>
				}

				<p class="userPopover-details-info-detail pr-u-marginTopXS">
					<!-- HORS CONTRAT-->
					@if (employee.dtContractStart | isFuture) {
						<span class="userPopover-details-info-detail-workplace">
							<lu-icon icon="calendarPlanning" size="S" />
							<span class="userPopover-details-info-detail-link-state">
								{{ intl.EMPLOYEE_CARD_PANEL_COMING_ON_LABEL | intlParams: { date: (employee.dtContractStart | date: "shortDate") } }}
							</span>
						</span>
					}
					<!-- Contrat terminé -->
					@if (!(employee.dtContractStart | isFuture) && !(employee.dtContractEnd | isFutureOrToday)) {
						<span class="userPopover-details-info-detail-workplace">
							<lu-icon icon="calendarStrikethrough" size="S" />
							<span class="userPopover-details-info-detail-link-state"> {{ intl.EMPLOYEE_CARD_PANEL_EMPLOYEE_HAS_LEAVED_LABEL }} </span>
						</span>
					}

					<!-- EN CONTRAT-->
					@if (employee._links?.schedule && !(employee.dtContractStart | isFuture) && (employee.dtContractEnd | isFutureOrToday)) {
						<a class="userPopover-details-info-detail-workplace" [href]="employee._links?.schedule?.href">
							@if (employee.isWorkingNow && employee.currentWorkLocation) {
								<lu-icon icon="mapPin" size="S" />
							}
							@if (!employee.isWorkingNow || !employee.currentWorkLocation) {
								<lu-icon icon="calendarPlanning" size="S" />
							}
							<span class="userPopover-details-info-detail-workplace-state">
								@if (employee.isWorkingNow) {
									@if (employee.currentWorkLocation) {
										{{ employee.currentWorkLocation?.name }}
										@if (employee.currentWorkLocation?.area) {
											<span class="pr-u-colorTextSubtle"> – {{ employee.currentWorkLocation?.area?.name }}</span>
										}
									}
									@if (!employee.currentWorkLocation) {
										{{ intl.EMPLOYEE_CARD_PANEL_PRESENT_LABEL }}
									}
								} @else {
									@if (!(employee.dtContractStart | isFuture) && (employee.dtContractEnd | isFutureOrToday)) {
										{{ intl.EMPLOYEE_CARD_PANEL_ABSENCE_LABEL }}
										@if (employee.leaveEndsOn) {
											<span class="pr-u-colorTextSubtle"> – {{ employee.leaveEndsOn | leaveEndsDisplay: employee.leaveEndIsFirstHalfDay }} </span>
										}
									}
								}
							</span>
						</a>
					}
				</p>
			</div>
		</section>
	</div>
} @else {
	<section class="userPopover skeleton is-loading" aria-busy="true">
		<div class="userPopover-details">
			<div
				class="userPopover-details-avatar avatar skeleton-item mod-circle"
				style="--components-skeleton-shape-width: 96px; --components-skeleton-shape-height: 96px"
			></div>
			<div class="userPopover-details-info">
				<h1
					class="userPopover-details-info-name skeleton-item pr-u-margin0"
					[style.--components-skeleton-text-width]="skeletonWidths[0]"
				></h1>
				<p
					class="userPopover-details-info-detail skeleton-item pr-u-bodyS"
					[style.--components-skeleton-text-width]="skeletonWidths[1]"
				></p>
				<p
					class="userPopover-details-info-detail skeleton-item pr-u-bodyS"
					[style.--components-skeleton-text-width]="skeletonWidths[2]"
				></p>
				<p
					class="userPopover-details-info-detail skeleton-item pr-u-bodyS"
					[style.--components-skeleton-text-width]="skeletonWidths[3]"
				></p>
			</div>
		</div>
	</section>
}
